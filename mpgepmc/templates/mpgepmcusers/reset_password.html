<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Reset Password - MPGEPMC</title>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
  <h1>Reset Password</h1>

  {% if messages %}
    <ul>
      {% for m in messages %}
        <li style="color:red">{{ m }}</li>
      {% endfor %}
    </ul>
  {% endif %}

  {% if remaining_seconds %}
    <p>This reset link will expire in: <span id="countdown"></span></p>
    <script>
      (function startCountdown(secs){
        function update(){
          if(secs <= 0){
            $("#countdown").text("Expired");
            return;
          }
          let m = Math.floor(secs/60);
          let s = secs % 60;
          $("#countdown").text(m + "m " + (s<10? "0":"") + s + "s remaining");
          secs -= 1;
          setTimeout(update, 1000);
        }
        $(function(){ update(); });
      })({{ remaining_seconds }});
    </script>
  {% endif %}

  <form method="post" action="">
    {% csrf_token %}
    {{ form.as_p }}
    <button type="submit">Set New Password</button>
  </form>

  <p><a href="{% url 'mpgepmcusers:signin' %}">Back to sign in</a></p>
</body>
</html>
